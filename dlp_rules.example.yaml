# Example DLP Rules Configuration
# Copy this file to dlp_rules.yaml and customize for your organization

rules:
  # Financial Data Protection
  - id: credit-card-detection
    name: Credit Card Number Detection
    description: Detects credit card numbers in files
    severity: high
    action: alert
    enabled: true
    patterns:
      - name: credit_card
        pattern: '\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|6(?:011|5[0-9]{2})[0-9]{12}|(?:2131|1800|35\d{3})\d{11})\b'
        case_sensitive: false
        whole_word: false
    min_matches: 1
    metadata:
      category: financial
      compliance: pci-dss

  - id: ssn-detection
    name: Social Security Number Detection
    description: Detects US Social Security Numbers
    severity: critical
    action: alert
    enabled: true
    patterns:
      - name: ssn
        pattern: '\b\d{3}-\d{2}-\d{4}\b'
        case_sensitive: false
        whole_word: false
      - name: ssn_no_dash
        pattern: '\b\d{9}\b'
        case_sensitive: false
        whole_word: true
    min_matches: 1
    metadata:
      category: pii
      compliance: hipaa, gdpr

  - id: bank-account-detection
    name: Bank Account Number Detection
    description: Detects bank account numbers
    severity: high
    action: alert
    enabled: true
    patterns:
      - name: bank_account
        pattern: '\b\d{8,17}\b'
        case_sensitive: false
        whole_word: true
    keywords:
      - "account number"
      - "routing number"
      - "bank account"
    min_matches: 2
    metadata:
      category: financial

  # Healthcare Data Protection
  - id: medical-record-detection
    name: Medical Record Number Detection
    description: Detects medical record numbers and healthcare identifiers
    severity: critical
    action: alert
    enabled: true
    patterns:
      - name: mrn
        pattern: 'MRN[:\s]*\d{6,10}'
        case_sensitive: false
        whole_word: false
    keywords:
      - "patient"
      - "diagnosis"
      - "prescription"
      - "medical record"
    min_matches: 1
    metadata:
      category: phi
      compliance: hipaa

  # Credentials and Secrets
  - id: api-key-detection
    name: API Key Detection
    description: Detects API keys and secrets
    severity: critical
    action: block
    enabled: true
    patterns:
      - name: api_key
        pattern: 'api[_-]?key["\s:=]+[a-zA-Z0-9_\-]{20,}'
        case_sensitive: false
        whole_word: false
      - name: secret_key
        pattern: 'secret[_-]?key["\s:=]+[a-zA-Z0-9_\-]{20,}'
        case_sensitive: false
        whole_word: false
      - name: aws_key
        pattern: 'AKIA[0-9A-Z]{16}'
        case_sensitive: true
        whole_word: false
    min_matches: 1
    metadata:
      category: secrets
      compliance: security

  - id: password-detection
    name: Password Detection
    description: Detects passwords in plain text
    severity: high
    action: alert
    enabled: true
    patterns:
      - name: password
        pattern: 'password["\s:=]+[^\s]{8,}'
        case_sensitive: false
        whole_word: false
    min_matches: 1
    metadata:
      category: secrets

  # Personal Information
  - id: email-address-detection
    name: Email Address Detection
    description: Detects email addresses
    severity: low
    action: log
    enabled: true
    patterns:
      - name: email
        pattern: '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
        case_sensitive: false
        whole_word: false
    min_matches: 5
    metadata:
      category: pii

  - id: phone-number-detection
    name: Phone Number Detection
    description: Detects phone numbers
    severity: low
    action: log
    enabled: true
    patterns:
      - name: us_phone
        pattern: '\b(?:\+?1[-.\s]?)?\(?([0-9]{3})\)?[-.\s]?([0-9]{3})[-.\s]?([0-9]{4})\b'
        case_sensitive: false
        whole_word: false
    min_matches: 3
    metadata:
      category: pii

  # Intellectual Property
  - id: confidential-marking
    name: Confidential Document Detection
    description: Detects documents marked as confidential
    severity: medium
    action: alert
    enabled: true
    keywords:
      - "confidential"
      - "proprietary"
      - "trade secret"
      - "internal only"
      - "do not distribute"
    min_matches: 1
    metadata:
      category: ip

  - id: source-code-detection
    name: Source Code Detection
    description: Detects source code in documents
    severity: medium
    action: alert
    enabled: false
    patterns:
      - name: function_def
        pattern: '(function|def|class)\s+\w+\s*\('
        case_sensitive: false
        whole_word: false
    keywords:
      - "import"
      - "require"
      - "include"
    file_extensions:
      - "txt"
      - "doc"
      - "docx"
      - "pdf"
    min_matches: 3
    metadata:
      category: ip

  # Compliance-Specific Rules
  - id: gdpr-data-subject
    name: GDPR Data Subject Information
    description: Detects GDPR-relevant personal data
    severity: high
    action: alert
    enabled: true
    keywords:
      - "date of birth"
      - "passport number"
      - "driver license"
      - "national id"
      - "biometric"
      - "genetic"
    min_matches: 1
    metadata:
      category: pii
      compliance: gdpr

  - id: hipaa-phi
    name: HIPAA Protected Health Information
    description: Detects HIPAA PHI indicators
    severity: critical
    action: alert
    enabled: true
    keywords:
      - "patient name"
      - "date of birth"
      - "medical condition"
      - "treatment"
      - "health insurance"
      - "medicare"
      - "medicaid"
    min_matches: 2
    metadata:
      category: phi
      compliance: hipaa

  # Custom Organization Rules
  - id: project-codename
    name: Project Codename Detection
    description: Detects internal project codenames (customize for your org)
    severity: medium
    action: alert
    enabled: false
    keywords:
      - "Project Phoenix"
      - "Operation Sunrise"
      - "Initiative Alpha"
    min_matches: 1
    metadata:
      category: ip
      custom: true

